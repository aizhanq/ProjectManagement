<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Projects</title>
    <!-- Подключаем стили Bootstrap для красивого вида -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8sh+WyK8t0H+aNQ9QUnh6lvm+6VI6kKg" crossorigin="anonymous">
</head>
<body class="container mt-5">
    <h2>Employee Projects</h2>

    <div class="mb-3">
        <label for="employeeDropdown" class="form-label">Select Employee:</label>
        <select class="form-select" id="employeeDropdown">
            <!-- Здесь будут опции с именами сотрудников -->
        </select>
    </div>

    <button type="button" class="btn btn-primary" onclick="getProjects()">Get Projects</button>

    <div class="mt-3">
        <h4>Projects:</h4>
        <ul id="projectList">
            <!-- Здесь будут отображаться проекты -->
        </ul>
    </div>

    <!-- Подключаем скрипт Axios для удобных HTTP-запросов -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        // Функция для заполнения выпадающего списка сотрудников
        async function fillEmployeeDropdown() {
            const employeeDropdown = document.getElementById('employeeDropdown');
            const response = await axios.get('/api/employee');
            const employees = response.data;

            employees.forEach(employee => {
                const option = document.createElement('option');
                option.value = employee.employeeId;
                option.text = `${employee.firstName} ${employee.lastName}`;
                employeeDropdown.add(option);
            });
        }

        // Функция для получения и отображения проектов сотрудника
        async function getProjects() {
            const employeeId = document.getElementById('employeeDropdown').value;
            const response = await axios.get(`/api/employee/${employeeId}/projects`);
            const projects = response.data;

            const projectList = document.getElementById('projectList');
            projectList.innerHTML = '';

            projects.forEach(project => {
                const listItem = document.createElement('li');
                listItem.textContent = `${project.projectName} (Priority: ${project.priority})`;
                projectList.appendChild(listItem);
            });
        }

        // Вызываем функцию для заполнения списка сотрудников при загрузке страницы
        fillEmployeeDropdown();
    </script>
</body>
</html>
